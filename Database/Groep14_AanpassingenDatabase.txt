Database model maken, wijzigingen in rood aangeven


Tabel gebruiker:

	gebruikersnaam 	van char(10) 	naar varchar(20)
	voornaam 		van char(5)		naar varchar(20)
	achternaam 		van char(8) 	naar varchar(20)
	adresregel1 	van char(15) 	naar varchar(20)
	adresregel2 	van char(15) 	naar varchar(20)
	plaatsnaam 		van char (12) 	naar varchar(20)
	land 			van char(9) 	naar varchar(20)
	geboortedag 	veranderd naar 'geboortedatum' met een date ipv char
	mailbox			veranderd naar 'mailadres' met een varchar(50) ipv char(18)
	wachtwoord 		van char(9) 	naar varchar(255)
	vraag			van integer(2) 	naar numeric(2)
	antwoordtekst	van char(6) 	naar varchar(50)
	verkoper 		veranderd naar 'rol' met een numeric(1) ipv char. De volgende lijst met nummers wordt hiervoor gebruikt:
		0:      geblokkeerd
		1:      te verifiÃ«ren (nieuwe gebruiker)
		2:      actieve gebruiker
		3:      verkoper
		4:      beheerder

	kolom toegevoegd genaamd 'profielfoto' met een datatype van varchar(255) en hij mag null zijn.

	3 constraints toegevoegd; geboortedatum mag niet na vandaag zijn, wachtwoord moet langer zijn dan 7 karakters en minimaal 1 letter en 1 nummer bevatten

Tabel vraag:

	vraagnummer		van char(21) 	naar numeric(2)
	tekstvraag		van char(21)	naar varchar(50)

Tabel gebruikerstelefoon:

	volgnr			van integer(2)	naar numeric(2)
	gebruiker		van char(10)	naar varchar(20)






Streven naar 100% conversersie
Default verkoper (onbekend) aanmaken

database maken van puur vuile data 
Script 	|
	   	|
	   \/
Nieuwe database



bodMoment -> datetime	not null default getdate()

land-> varchar(56) maken


voorwerp -> database laten bereken hoelang


create function fnWieIsVerkoper (@voorwerpNummer INT) 	
RETURNS varchar(20)
as
begin
	return
		( Select verkoper from voorwerp where voorwerpnummer = @voorwerpNummer)\
end

alter table bod
add constraint ck_bod_nietBiedenEigenProduct check (dbo.fnWieIsVerkoper(voorwerpNummer) <> gebruikersNaam)




create function fnveilingisgesloten (@voorwerpnummer INT) returns bit 
as
begin
return(
	select veilinggesloten
	from voorwerp
	where voorwerpnummer = @voorwerpNummer
)

alter table bod
add constraint .. check (functie(ding)=0)




hoogstebieder @voornummer integerreturn varchar 20
return (
	select TOP 1 b.gebruikersnaam
	from voorwerp v
	inner join bod B on v.voorwerpnummer = b.voorwerpnummer
	where v.voorwerpnummer = @voorwerpNummer and veilinggesloten - 1
	group by 1 ding
)



raiserror
throw